# CSRF Vulnerability

CSRF (Cross-Site Request Forgery) is a web security vulnerability in which an attacker tricks a user's browser into sending unauthorized requests to a trusted website while the user is authenticated, allowing the attacker to perform actions as the user by abusing the user's active session, without the user's knowledge or consent.

## LOW
<img width="1875" height="929" alt="Screenshot from 2026-02-01 15-58-40" src="https://github.com/user-attachments/assets/8c18a6b7-723e-46ef-9aba-fc7f70200c17" />

No security measures. I noticed the URL when changing the password:
```
localhost:8000/vulnerabilities/csrf/?password_new=test&password_conf=test&Change=Change#
```

For example, if someone tricked me to click that link, my password will be changed without any other verifications.

## MEDIUM

This time the trick didn't work on me because the developer relied on the Referer header, assuming that if it matched the application's domain, the request must have originated from the web application and could therefore be trusted.

Referer is an HTTP header that indicates the URL of the web page that initiated a request.


<img width="1920" height="882" alt="Screenshot from 2026-02-01 16-10-34" src="https://github.com/user-attachments/assets/d52a08e8-3e42-40db-83f1-ba64db1e56fd" />


So I decided to add a Referer header containing the website's URL.


<img width="1920" height="882" alt="Screenshot from 2026-02-01 16-11-45" src="https://github.com/user-attachments/assets/3c3e85cd-0c3b-4e8c-85f9-cab929515f3c" />

To abuse this, an attacker can craft a malicious link pointing to this redirect page, with the destination set to the sensitive endpoint. When a logged-in user clicks the link, the browser first visits a page on the target domain and then is redirected to the sensitive action.

## HIGH

A CSRF token is used to ensure that an attacker cannot craft authenticated requests, because the attacker cannot guess or access the secret token value.

A CSRF token is a unique, unpredictable value generated by the server and included in each sensitive request, which is verified on submission to ensure that the request was intentionally made by the authenticated user and not forged by an attacker.

<img width="1920" height="901" alt="Screenshot from 2026-02-01 16-50-58" src="https://github.com/user-attachments/assets/9f443bba-7af5-46e7-a15e-b108b20a3606" />


But this is only possible if it's chained with an XSS vulnerability so the attacker can obtain the CSRF token. If an application has an XSS vulnerability, an attacker can execute JavaScript in the user's browser, extract the CSRF token from the page, and reuse it in a forged request, thereby bypassing CSRF protection.

So we are just simulating the attack; from the page source, the CSRF token can be extracted (assuming the attacker obtained it somehow).

<img width="884" height="164" alt="Screenshot from 2026-02-01 17-08-32" src="https://github.com/user-attachments/assets/08d72a5d-5ad3-41bc-85eb-475864677c7a" />


Now use it to change the password.

<img width="1920" height="862" alt="Screenshot from 2026-02-01 17-08-44" src="https://github.com/user-attachments/assets/2a5bf4e3-12c6-4bbc-aab1-4385eb23deb1" />
